{"version":3,"sources":["config/config.ts","redux/spotify/utils.ts","redux/spotify/actions.ts","redux/spotify/types.ts","components/MoodSlider/MoodSlider.styles.tsx","components/MoodSlider/MoodSlider.tsx","components/Player/style.ts","components/Player/index.tsx","App.style.ts","components/NoActivePlayerWarning/styles.tsx","components/NoActivePlayerWarning/index.tsx","App.tsx","redux/mood/actions.ts","redux/mood/types.ts","utils.ts","serviceWorker.ts","redux/spotify/reducer.ts","redux/mood/reducer.ts","redux/rootReducer.ts","config/head.ts","components/Head/Head.tsx","index.tsx"],"names":["authEndpoint","clientId","redirectUri","scopes","shuffleArray","array","shuffled","i","length","j","Math","floor","random","getSongsAmount","a","axios","get","params","limit","portion","data","total","Error","fetchPortionSongDetails","offset","items","map","item","id","track","title","name","artist","artists","albumCover","album","images","url","fetchPortionSongMood","ids","audio_features","valence","energy","danceability","getColorsFromAlbumCover","Vibrant","from","getPalette","palette","Object","assign","keys","k","r","_rgb","toFixed","g","b","saveSongsToIndexedDb","allSongs","song","localforage","setItem","getNearestSong","distance","sqrt","pow","reduce","previous","current","setStatus","status","type","payload","songsLoadingStatus","RangeSlider","styled","input","MoodSlider","props","onReleased","useState","value","setValue","previousValue","setPreviousValue","gripReleased","float","Number","min","max","className","onChange","e","target","onMouseUp","onMouseDown","onTouchEnd","onTouchStart","AlbumCover","img","Title","h2","Author","Player","src","alt","gradient","keyframes","Main","color1","color2","Logo","SpotifyButton","MoodLabel","p","PlayerMoodContainer","blurred","LoadingSongs","span","WarningContainer","div","WarningTitle","h1","WarningText","WarningButton","button","NoActivePlayerWarning","onClick","connect","state","isTokenExpired","spotify","isSpotifyPlayerActive","actualSong","dispatch","bindActionCreators","tokenRefreshed","setValency","setEnergy","setDanceability","playMoodSong","getState","console","log","mood","iterate","push","nearest","utils","colors","put","uris","message","includes","response","fetchSongs","len","totalAmount","songsDetails","indexes","Array","round","slice","maxSongs","details","chunks","join","songsMood","chunk","songs","itm","find","token","setToken","useEffect","_token","localStoragedToken","localStorage","getItem","hash","window","location","substring","split","initial","parts","decodeURIComponent","access_token","defaults","headers","common","handleValencyChange","React","useCallback","handleEnergyChange","handleDanceabilityChange","Muted","DarkMuted","DarkVibrant","href","config","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","error","initialState","reducer","action","rootReducer","combineReducers","spotifyReducer","moodReducer","head","Head","description","keywords","Helmet","property","content","store","createStore","applyMiddleware","thunk","ReactDOM","render","StrictMode","document","getElementById","URL","process","origin","addEventListener","fetch","contentType","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.a1c33566.chunk.js","sourcesContent":["export default {\n    authEndpoint: 'https://accounts.spotify.com/authorize',\n    clientId: \"056a2f6da4284c55980882095f831b4d\",\n    //redirectUri: process.env.NODE_ENV !== \"production\" ? \"http://localhost:3000/\": \"https://moodify.marekchoinski.com/\",\n    redirectUri: \"https://moodify.marekchoinski.com/\",\n    scopes: [\n        \"user-library-read\",\n        \"user-modify-playback-state\",\n    ],\n};\n\nexport const maxSongs: number = 10000;","import axios from 'axios';\n\nimport * as types from './types';\nimport Vibrant from 'node-vibrant';\n\nimport localforage from 'localforage';\n\n\n//tested\nexport const shuffleArray = (array: number[]) => {\n    let shuffled = [...array];\n\n    for (let i = shuffled.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];\n    }\n    return shuffled;\n}\n\n//tested\nexport const getSongsAmount = async (): Promise<number> => {\n    try {\n        const portion = await axios.get('https://api.spotify.com/v1/me/tracks', {\n            params: {\n                limit: 1,\n            }\n        });\n\n        return portion.data.total;\n\n    } catch (error) {\n        throw new Error(error);\n    }\n}\n\n//tested\nexport const fetchPortionSongDetails = async (\n    offset: number,\n): Promise<types.SongInformation[]> => {\n    const portion = await axios.get('https://api.spotify.com/v1/me/tracks', {\n        params: {\n            offset: offset * 50,\n            limit: 50, // max limit according to spotify documentation\n        }\n    });\n\n    return portion.data.items.map((item: any) => ({\n        id: item.track.id,\n        title: item.track.name,\n        artist: item.track.artists[0].name,\n        albumCover: item.track.album.images[0].url,\n    }));\n};\n\n//tested\nexport const fetchPortionSongMood = async (\n    ids: string,\n): Promise<types.SongMood[]> => {\n    const portion = await axios.get('https://api.spotify.com/v1/audio-features', {\n        params: {\n            ids\n        }\n    });\n\n    return portion.data.audio_features.map((item: any) => ({\n        id: item.id,\n        valence: item.valence,\n        energy: item.energy,\n        danceability: item.danceability,\n    }));\n};\n\n//testing\nexport const getColorsFromAlbumCover = async (albumCover: string) => {\n    let palette: any = await Vibrant.from(albumCover).getPalette();\n\n    // return palette;\n\n    return Object.assign({},\n        ...Object.keys(palette).map(k => ({\n            [k]: {\n                r: palette[k]._rgb[0].toFixed(0),\n                g: palette[k]._rgb[1].toFixed(0),\n                b: palette[k]._rgb[2].toFixed(0),\n            }\n        }))\n    );\n}\n\nexport const saveSongsToIndexedDb = async (allSongs: types.Song[]): Promise<void> => {\n    //await localforage.clear(); //TODO not neccesary tbh\n    for (const song of allSongs) {\n        await localforage.setItem(song.id, song);\n    }\n};\n\n//TODO dont work\nexport const songsSavedToIndexedDB = async (): Promise<boolean> => {\n    let len = await localforage.length();\n    console.log(len, \" localforage.length()\");\n\n    return !!len;\n};\n\nexport const getNearestSong = (\n    allSongs: types.Song[],\n    valence: number,\n    energy: number,\n    danceability: number,\n): types.Song => {\n    const distance = (song: types.Song) => {\n        return Math.sqrt(\n            Math.pow((song.valence - valence), 2) +\n            Math.pow((song.energy - energy), 2) +\n            Math.pow((song.danceability - danceability), 2)\n        );\n    };\n\n    return allSongs.reduce((previous: types.Song, current: types.Song) =>\n        distance(previous) < distance(current) ? previous : current\n    );\n\n};","import { Dispatch } from \"redux\";\n\nimport * as types from './types';\nimport * as utils from './utils';\nimport axios from 'axios';\nimport { maxSongs } from '../../config/config';\nimport localforage from \"localforage\";\n\n\ninterface ITokenExpirationAction {\n    type: typeof types.TOKEN_EXPIRED | typeof types.TOKEN_REFRESHED;\n}\n\nexport const tokenExpired = (): ITokenExpirationAction => ({\n    type: types.TOKEN_EXPIRED,\n});\n\nexport const tokenRefreshed = (): ITokenExpirationAction => ({\n    type: types.TOKEN_REFRESHED,\n});\n\ninterface IPlayerActive {\n    type: typeof types.NO_ACTIVE_PLAYER | typeof types.IS_ACTIVE_PLAYER;\n}\n\nexport const noActivePlayer = (): IPlayerActive => ({\n    type: types.NO_ACTIVE_PLAYER,\n});\n\nexport const isActivePlayer = (): IPlayerActive => ({\n    type: types.IS_ACTIVE_PLAYER,\n});\n\n\ninterface ISetActualPlayingSongAction {\n    type: typeof types.SET_ACTUAL_SONG;\n    payload: {\n        actualSong: types.Song & types.SongColor,\n    }\n}\n\nexport const setActualPlayingSong = (song: types.Song & types.SongColor): ISetActualPlayingSongAction => ({\n    type: types.SET_ACTUAL_SONG,\n    payload: {\n        actualSong: song,\n    }\n});\n\n//TODO is loading action\nexport const playMoodSong = () => async (\n    dispatch: Dispatch,\n    getState: () => any,\n): Promise<void> => {\n    try {\n        console.log(\"weszlo\");\n\n\n        const allSongs: types.Song[] = [];\n        const valence: number = getState().mood.valence\n        const energy: number = getState().mood.energy\n        const danceability: number = getState().mood.danceability\n\n        await localforage.iterate((value: types.Song) => {\n            allSongs.push(value);\n        });\n\n        if (!allSongs.length) return;\n\n        let nearest = utils.getNearestSong(allSongs, valence, energy, danceability);\n        let palette = await utils.getColorsFromAlbumCover(nearest.albumCover);\n\n\n        dispatch(setActualPlayingSong({\n            ...nearest,\n            colors: palette,\n        }));\n\n        await axios.put('https://api.spotify.com/v1/me/player/play', {\n            uris: [`spotify:track:${nearest.id}`],\n        });\n\n        // player is active and successfully plays song\n        dispatch(isActivePlayer());\n\n    } catch (error) {\n        dispatch(setStatus(\"waiting\"));\n\n        if (error.message.includes(\"401\") ||\n            (error.response && error.response.status === 401)) {\n            dispatch(tokenExpired());\n        }\n\n        if (error.message.includes(\"404\")) {\n            dispatch(noActivePlayer());\n        }\n\n        else {\n            console.log(error);\n        }\n    }\n\n};\n\ninterface ILoadingStatusAction {\n    type: typeof types.LOADING_STATUS_CHANGE;\n    payload: {\n        songsLoadingStatus: types.loadingStatus,\n    };\n}\n\nexport const setStatus = (status: types.loadingStatus): ILoadingStatusAction => ({\n    type: types.LOADING_STATUS_CHANGE,\n    payload: {\n        songsLoadingStatus: status,\n    }\n});\n\ninterface IGetSongsAction {\n    type: typeof types.GET_SONGS;\n    payload: {\n        songs: types.Song[],\n    };\n}\n\nexport const getSongs = (songs: types.Song[]): IGetSongsAction => ({\n    type: types.GET_SONGS,\n    payload: {\n        songs,\n    }\n});\n\n//TODO is loading action\nexport const fetchSongs = (playMoodSong: () => Promise<void>) => async (\n    dispatch: Dispatch,\n): Promise<void> => {\n    try {\n\n        dispatch(setStatus(\"loading\"));\n\n        let len = await localforage.length();\n        console.log(len, \" localforage.length()\");\n\n        // let isSaved = await utils.songsSavedToIndexedDB\n\n        if (!len) {\n            let totalAmount = await utils.getSongsAmount();\n            let songsDetails: types.SongInformation[] = [];\n\n            let indexes = [...Array(Math.round(totalAmount / 50)).keys()];\n\n            if (totalAmount > maxSongs) {\n                // get random indexes in range of max amount\n                indexes = utils.shuffleArray(indexes).slice(0, Math.round(maxSongs / 50));\n            }\n\n            for (let i of indexes) {\n                const portion = await utils.fetchPortionSongDetails(i);\n                songsDetails = [...songsDetails, ...portion];\n            }\n\n            const ids = songsDetails.map(details => details.id);\n\n            let chunks: string[] = [];\n\n            //splice to chunk of 100\n            for (let i = 0; i < ids.length; i += 100) {\n                chunks.push(ids.slice(i, i + 100).join(','))\n            }\n\n            let songsMood: types.SongMood[] = [];\n\n            for (const chunk of chunks) {\n                const portion = await utils.fetchPortionSongMood(chunk);\n                songsMood = [...songsMood, ...portion];\n            }\n\n            const songs = (songsDetails as types.Song[]).map(itm => ({\n                ...songsMood.find((item) => (item.id === itm.id) && item),\n                ...itm\n            }));\n\n            await utils.saveSongsToIndexedDb(songs);\n        }\n\n        // dispatch(getSongs(songs));\n\n        dispatch(setStatus(\"loaded\"));\n\n        await playMoodSong();\n\n    } catch (error) {\n        dispatch(setStatus(\"waiting\"));\n\n        if (error.message.includes(\"401\") ||\n            (error.response && error.response.status === 401)) {\n            dispatch(tokenExpired());\n        }\n\n        else {\n            console.log(error);\n        }\n    }\n\n};\n\nexport type SpotifyActionsTypes =\n    ITokenExpirationAction |\n    IPlayerActive |\n    IGetSongsAction |\n    ILoadingStatusAction |\n    ISetActualPlayingSongAction;\n\n\n","export const TOKEN_EXPIRED = \"moodify/TOKEN_EXPIRED\";\nexport const TOKEN_REFRESHED = \"moodify/TOKEN_REFRESHED\";\nexport const IS_ACTIVE_PLAYER = \"moodify/IS_ACTIVE_PLAYER\";\nexport const NO_ACTIVE_PLAYER = \"moodify/NO_ACTIVE_PLAYER\";\nexport const GET_SONGS = \"moodify/GET_SONGS\";\nexport const LOADING_STATUS_CHANGE = \"moodify/LOADING_STATUS_CHANGE\";\nexport const SET_ACTUAL_SONG = \"moodify/SET_ACTUAL_SONG\";\n\nexport type SongInformation = {\n    id: string,\n    title: string,\n    artist: string,\n    albumCover: string,\n}\n\nexport type SongMood = {\n    id: string,\n    valence: number,\n    energy: number,\n    danceability: number,\n};\n\nexport type SongColor = {\n    colors: {\n        \"Vibrant\": Color,\n        \"LightVibrant\": Color,\n        \"DarkVibrant\": Color,\n        \"Muted\": Color,\n        \"LightMuted\": Color,\n        \"DarkMuted\": Color,\n    }\n};\n\nexport type Color = {\n    r: string,\n    g: string,\n    b: string,\n};\n\nexport type Song = SongInformation & SongMood;\n\nexport type loadingStatus = \"waiting\" | \"loading\" | \"loaded\";\n\nexport interface ISpotifyState {\n    readonly isTokenExpired: boolean,\n    readonly songsLoadingStatus: loadingStatus,\n    readonly songs: Song[],\n    readonly actualSong: Song & SongColor | null,\n    readonly isSpotifyPlayerActive: boolean,\n}\n","import styled from 'styled-components'\n\nexport const RangeSlider = styled.input`\n    &[type=range] {\n        -webkit-appearance: none;\n        width: 100%;\n        margin: 5.6px 0;\n        background: transparent;\n      \n        &:focus {\n            outline: none;\n        }\n    }\n\n    &[type=range]::-webkit-slider-runnable-track {\n        width: 100%;\n        height: 4.8px;\n        cursor: pointer;\n        box-shadow: 0.5px 0.5px 2.6px rgba(0, 0, 0, 0.32), 0px 0px 0.5px rgba(13, 13, 13, 0.32);\n        background: rgba(255, 255, 255, 0.5);\n        border-radius: 2.1px;\n        border: 0px solid #180001;\n    }\n\n    &[type=range]::-webkit-slider-thumb {\n        box-shadow: 0px 0px 0px rgba(0, 0, 0, 0), 0px 0px 0px rgba(13, 13, 13, 0);\n        border: 0.5px solid rgba(0, 0, 0, 0.13);\n        height: 12px;\n        width: 12px;\n        border-radius: 50px;\n        background: #ffffff;\n        cursor: pointer;\n        -webkit-appearance: none;\n        margin-top: -5.6px;\n    }\n\n    &[type=range]:focus::-webkit-slider-runnable-track {\n        background: rgba(255, 255, 255, 0.6);\n    }\n\n    &[type=range]::-moz-range-track {\n        width: 100%;\n        height: 4.8px;\n        cursor: pointer;\n        box-shadow: 0.5px 0.5px 2.6px rgba(0, 0, 0, 0.32), 0px 0px 0.5px rgba(13, 13, 13, 0.32);\n        background: rgba(255, 255, 255, 0.5);\n        border-radius: 2.1px;\n        border: 0px solid #180001;\n    }\n\n    &[type=range]::-moz-range-thumb {\n        box-shadow: 0px 0px 0px rgba(0, 0, 0, 0), 0px 0px 0px rgba(13, 13, 13, 0);\n        border: 0.5px solid rgba(0, 0, 0, 0.13);\n        height: 12px;\n        width: 12px;\n        border-radius: 50px;\n        background: #ffffff;\n        cursor: pointer;\n    }\n\n    &[type=range]::-ms-track {\n        width: 100%;\n        height: 4.8px;\n        cursor: pointer;\n        background: transparent;\n        border-color: transparent;\n        color: transparent;\n    }\n\n    &[type=range]::-ms-fill-lower {\n        background: rgba(156, 156, 156, 0.5);\n        border: 0px solid #180001;\n        border-radius: 4.2px;\n        box-shadow: 0.5px 0.5px 2.6px rgba(0, 0, 0, 0.32), 0px 0px 0.5px rgba(13, 13, 13, 0.32);\n    }\n\n    &[type=range]::-ms-fill-upper {\n        background: rgba(255, 255, 255, 0.5);\n        border: 0px solid #180001;\n        border-radius: 4.2px;\n        box-shadow: 0.5px 0.5px 2.6px rgba(0, 0, 0, 0.32), 0px 0px 0.5px rgba(13, 13, 13, 0.32);\n    }\n\n    &[type=range]::-ms-thumb {\n        box-shadow: 0px 0px 0px rgba(0, 0, 0, 0), 0px 0px 0px rgba(13, 13, 13, 0);\n        border: 0.5px solid rgba(0, 0, 0, 0.13);\n        height: 12px;\n        width: 12px;\n        border-radius: 50px;\n        background: #ffffff;\n        cursor: pointer;\n        height: 4.8px;\n    }\n\n    &[type=range]:focus::-ms-fill-lower {\n        background: rgba(255, 255, 255, 0.5);\n    }\n\n    &[type=range]:focus::-ms-fill-upper {\n        background: rgba(255, 255, 255, 0.5);\n    }\n`;","import React, { useState } from \"react\";\nimport { RangeSlider } from \"./MoodSlider.styles\";\n\n\ntype Props = {\n    onReleased: (v: number) => void;\n};\n\nconst MoodSlider: React.FC<Props> = props => {\n\n    const { onReleased } = props;\n\n    const [value, setValue] = useState(\"500\");\n\n    const [previousValue, setPreviousValue] = useState(\"500\");\n\n    const gripReleased = () => {\n        if (previousValue !== value) {\n            let float = Number(value) * 0.001;\n            onReleased(float);\n        }\n        setPreviousValue(value);\n    };\n\n    return (\n        <RangeSlider\n            type=\"range\"\n            min=\"0\"\n            max=\"1000\"\n            value={value}\n            className=\"slider\"\n            onChange={(e) => setValue(e.target.value)}\n            onMouseUp={() => gripReleased()}\n            onMouseDown={() => setPreviousValue(value)}\n            onTouchEnd={() => gripReleased()}\n            onTouchStart={() => setPreviousValue(value)}\n        />\n\n    );\n};\n\nexport default MoodSlider;","import styled from 'styled-components'\n\nexport const AlbumCover = styled.img`\n    width: 100%;\n    height: auto;\n`;\n\nexport const Title = styled.h2`\n    font-size: 20px;\n    color: white;\n    opacity: 0.7;\n`;\n\nexport const Author = styled.h2`\n    font-size: 16px;\n    color: white;\n    opacity: 0.5;\n    margin-bottom: 30px;\n`;\n","import React from \"react\";\n\nimport { AlbumCover, Title, Author } from './style';\n\ntype Props = {\n    title: string,\n    artist: string,\n    albumCover: string,\n};\n\nconst Player: React.FC<Props> = props => {\n\n    const {\n        title,\n        artist,\n        albumCover,\n    } = props;\n\n    return (\n        <>\n            <AlbumCover src={albumCover} alt=\"Album cover\" />\n            <Title>{title}</Title>\n            <Author>{artist}</Author>\n        </>\n    );\n};\n\nexport default Player;","import styled, { keyframes } from 'styled-components'\n\nimport { Color } from './redux/spotify/types';\n\nconst gradient = keyframes`\n\t0% {\n\t\tbackground-position: 0% 0%;\n\t}\n\t50% {\n\t\tbackground-position: 100% 100%;\n\t}\n\t100% {\n\t\tbackground-position: 0% 0%;\n    }\n`;\n\ninterface IGradientBackground {\n    color1: Color,\n    color2: Color,\n}\n\nexport const Main = styled(\"main\") <IGradientBackground>`\n    height: 100vh;\n    width: 100vw;\n    box-sizing: border-box;\n    padding: 0 70px;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    background: ${props => (props.color1 && props.color2 ?\n        `linear-gradient(115deg, \n                rgb(41,41,41),\n                rgb(${props.color2.r},${props.color2.g},${props.color2.b}),\n                rgb(${props.color1.r},${props.color1.g},${props.color1.b}),\n                rgb(${props.color2.r},${props.color2.g},${props.color2.b}),\n                rgb(41,41,41))`\n        : `linear-gradient(115deg, \n                black,\n                rgb(41,41,41),\n                #062F14,\n                rgb(41,41,41),\n                black)`)};\n\n\n\n\n    background-size: 500% 500%;\n    animation: ${gradient} 60s ease-in-out infinite;\n\n    @media (max-width: 740px) {\n        padding: 0 5vw;\n    }\n`;\n\nexport const Logo = styled(\"h1\") <IGradientBackground>`\n    align-self: flex-start;\n    font-size: 3.5rem;\n    font-weight: bold;\n    margin-bottom: 0px;\n    background: ${props => (props.color1 && props.color2 ?\n        `linear-gradient(45deg, \n                rgb(${props.color1.r},${props.color1.g},${props.color1.b}),\n                rgb(${props.color2.r},${props.color2.g},${props.color2.b}),\n                rgb(${props.color1.r},${props.color1.g},${props.color1.b}))`\n        : `linear-gradient(45deg, \n                #1DB954,\n                #0D5125,\n                #1DB954)`)};\n\n    background-clip: text;\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-size: 400% 400%;\n\n    animation: ${gradient} 15s ease infinite;\n\n    @media (max-width: 740px) {\n        font-size: 3.1rem;\n    }\n`;\n\nexport const SpotifyButton = styled.a`\n    font-size: 1rem;\n    font-weight: bold;\n    background-color: #1DB954;\n    text-decoration: none;\n    color: white;\n    border-radius: 100px;\n    padding: 15px 30px;\n    margin: auto;\n`;\n\nexport const MoodLabel = styled.p`\n\tfont-size: 12px;\n\tcolor: white;\n\topacity: 0.5;\n\twidth: 500px;\n\tfont-weight: bold;\n\tpadding: 0;\n    margin: 10px 0 0 0; \n`;\n\ninterface IBlurrable {\n    blurred: boolean,\n}\n\nexport const PlayerMoodContainer = styled(\"div\") <IBlurrable>`\n    max-width: 500px;\n    width: 100%;\n    ${props => props.blurred ? \"filter: blur(10px)\" : \"\"};\n`;\n\nexport const LoadingSongs = styled.span`\n    font-size: 16px;\n\tcolor: white;\n\topacity: 0.6;\n    font-weight: bold;\n    display: block;\n    margin: auto 0;\n    padding: 50px 30px;\n    background-color: rgba(255,255,255,0.1);\n    border-radius: 10px;\n`;\n\n","import styled from 'styled-components'\n\nexport const WarningContainer = styled.div`\n    position: fixed;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    background-color: rgba(0,0,0,0.7);\n    z-index: 999;\n    color: white;\n    border-radius: 8px;\n    padding: 20px;\n    font-weight: normal;\n`;\n\nexport const WarningTitle = styled.h1`\n    font-size: 16px;\n    color: #1DB954;\n`;\n\nexport const WarningText = styled.p`\n    font-size: 14px;\n`;\n\nexport const WarningButton = styled.button`\n\tcolor: white;\n\tbackground-color: transparent;\n\tborder: 1px solid white;\n\tborder-radius: 5px;\n\ttext-transform: uppercase;\n\tfont-weight: bold;\n\tpadding: 7px 15px;\n\tmargin-left: auto;\n\tdisplay: block;\n\n    :hover{\n        background-color: rgba(255,255,255,0.2);\n    }\n    :active{\n        background-color: rgba(255,255,255,0.4);\n    }\n`;\n\n","import React from \"react\";\nimport {\n    WarningContainer,\n    WarningTitle,\n    WarningText,\n    WarningButton\n} from \"./styles\";\n\ntype Props = {\n    onClick: () => void;\n};\n\nconst NoActivePlayerWarning: React.FC<Props> = props => {\n\n    const { onClick } = props;\n\n    return (\n        <WarningContainer>\n            <WarningTitle>\n                Active player not found\n            </WarningTitle>\n            <WarningText>\n                Moodify can't find any active player. Try open spotify player and press \"Play\" button.\n            </WarningText>\n            <WarningButton onClick={onClick}>\n                Refresh\n            </WarningButton>\n        </WarningContainer>\n    );\n};\n\nexport default NoActivePlayerWarning;","import React, { useState, useEffect} from 'react';\nimport { connect } from 'react-redux'\nimport { getArgumentFromHash } from './utils';\n\nimport config from './config/config';\nimport './style.css';\n\nimport axios from 'axios';\n\nimport { tokenRefreshed, fetchSongs, playMoodSong } from './redux/spotify/actions';\nimport {\n  setValency,\n  setEnergy,\n  setDanceability,\n} from './redux/mood/actions';\nimport { bindActionCreators } from 'redux';\nimport MoodSlider from './components/MoodSlider/MoodSlider';\nimport Player from './components/Player';\nimport { Main, Logo, SpotifyButton, MoodLabel, PlayerMoodContainer, LoadingSongs } from './App.style';\nimport NoActivePlayerWarning from './components/NoActivePlayerWarning';\n\n\nconst mapStateToProps = (state: any) => ({\n  isTokenExpired: state.spotify.isTokenExpired,\n  isSpotifyPlayerActive: state.spotify.isSpotifyPlayerActive,\n  actualSong: state.spotify.actualSong,\n});\n\nconst mapDispatchToProps = (dispatch: any) =>\n  bindActionCreators(\n    {\n      tokenRefreshed: () => tokenRefreshed(),\n      setValency: (value) => setValency(value),\n      setEnergy: (value) => setEnergy(value),\n      setDanceability: (value) => setDanceability(value),\n      playMoodSong: () => playMoodSong(),\n      fetchSongs: (playMoodSong) => fetchSongs(playMoodSong),\n    },\n    dispatch\n  );\n\ntype Props = ReturnType<typeof mapStateToProps> &\n  ReturnType<typeof mapDispatchToProps>;\n\nconst App: React.FC<Props> = (props) => {\n\n  const {\n    isTokenExpired,\n    isSpotifyPlayerActive,\n    fetchSongs,\n    setValency,\n    setEnergy,\n    setDanceability,\n    playMoodSong,\n    actualSong,\n  } = props;\n\n  const [token, setToken] = useState(\"\");\n\n  useEffect(() => {\n    console.log(\"test\");\n\n    const localStoragedToken = localStorage.getItem(\"token\");\n    let _token: string = \"\";\n\n    // check if there is token already in localstorage\n    // and check if it isn't expired\n    // if no - try to achieve this from url\n    console.log(isTokenExpired, !localStoragedToken, localStoragedToken === \"undefined\");\n    if (isTokenExpired || !localStoragedToken) {\n      const hash: any = getArgumentFromHash();\n      window.location.hash = \"\";\n      localStorage.setItem('token', hash.access_token || \"\");\n    }\n    _token = localStorage.getItem(\"token\") || \"\";\n    console.log(_token);\n\n\n    // if token is available\n    if (_token) {\n      axios.defaults.headers.common = { 'Authorization': `Bearer ${_token}` };\n      fetchSongs(playMoodSong);\n    }\n\n    tokenRefreshed();\n    setToken(_token);\n\n  }, [isTokenExpired, fetchSongs, playMoodSong]);\n\n\n  const handleValencyChange = React.useCallback((value: number) => {\n\n    setValency(value);\n    playMoodSong();\n\n  }, [setValency, playMoodSong]);\n\n  const handleEnergyChange = React.useCallback((value: number) => {\n\n    setEnergy(value);\n    playMoodSong();\n\n  }, [setEnergy, playMoodSong]);\n\n  const handleDanceabilityChange = React.useCallback((value: number) => {\n\n    setDanceability(value);\n    playMoodSong();\n\n  }, [setDanceability, playMoodSong]);\n\n  return (\n    <Main\n      color1={actualSong && actualSong.colors.Muted}\n      color2={actualSong && actualSong.colors.DarkMuted}\n    >\n      <Logo\n        color1={actualSong && actualSong.colors.Vibrant}\n        color2={actualSong && actualSong.colors.DarkVibrant}\n      >\n        Moodify\n      </Logo>\n\n      {!isSpotifyPlayerActive && token &&\n        <NoActivePlayerWarning\n          onClick={() => playMoodSong()}\n        />\n      }\n\n      {token ?\n\n        (actualSong ?\n          <PlayerMoodContainer blurred={!isSpotifyPlayerActive as boolean}>\n            <Player\n              title={actualSong.title}\n              artist={actualSong.artist}\n              albumCover={actualSong.albumCover}\n            />\n            <MoodLabel> How happy are you? </MoodLabel>\n            <MoodSlider\n              onReleased={handleValencyChange} />\n            <MoodLabel> Are you full of energy? </MoodLabel>\n            <MoodSlider\n              onReleased={handleEnergyChange} />\n            <MoodLabel> How about dance? </MoodLabel>\n            <MoodSlider\n              onReleased={handleDanceabilityChange} />\n\n          </PlayerMoodContainer> :\n          <LoadingSongs>Loading songs from your Spotify...</LoadingSongs>\n        ) :\n\n        <SpotifyButton\n          className=\"btn btn--loginApp-link\"\n          href={`${config.authEndpoint}?client_id=${config.clientId}&redirect_uri=${config.redirectUri}&scope=${config.scopes.join(\n            \"%20\"\n          )}&response_type=token&show_dialog=true`}\n        >\n          Connect with Spotify\n        </SpotifyButton >\n      }\n\n    </Main>\n  );\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(App);\n","import * as types from './types';\n\ninterface ISetValenceAction {\n    type: typeof types.SET_VALENCE;\n    payload: {\n        valence: number,\n    };\n}\n\nexport const setValency = (valence: number): ISetValenceAction => ({\n    type: types.SET_VALENCE,\n    payload: {\n        valence,\n    },\n});\n\ninterface ISetEnergyAction {\n    type: typeof types.SET_ENERGY;\n    payload: {\n        energy: number,\n    };\n}\n\nexport const setEnergy = (energy: number): ISetEnergyAction => ({\n    type: types.SET_ENERGY,\n    payload: {\n        energy,\n    },\n});\n\ninterface ISetDanceabilityAction {\n    type: typeof types.SET_DANCEABILITY;\n    payload: {\n        danceability: number,\n    };\n}\n\nexport const setDanceability = (danceability: number): ISetDanceabilityAction => ({\n    type: types.SET_DANCEABILITY,\n    payload: {\n        danceability,\n    },\n});\n\n\nexport type MoodActionsTypes =\n    ISetValenceAction |\n    ISetEnergyAction |\n    ISetDanceabilityAction;\n\n","export const SET_VALENCE = \"moodify/SET_VALENCE\";\nexport const SET_ENERGY = \"moodify/SET_ENERGY\";\nexport const SET_DANCEABILITY = \"moodify/SET_DANCEABILITY\";\n\nexport interface IMoodState {\n    readonly valence: number,\n    readonly energy: number,\n    readonly danceability: number,\n}\n\n\n","export const getArgumentFromHash = (): any => window.location.hash\n    .substring(1)\n    .split(\"&\")\n    .reduce((initial: any, item: any) => {\n        if (item) {\n            let parts = item.split(\"=\");\n            initial[parts[0]] = decodeURIComponent(parts[1]);\n        }\n        return initial;\n    }, {});","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]' ||\n  // 127.0.0.0/8 are considered localhost for IPv4.\n  window.location.hostname.match(\n    /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n  )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n            'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","\nimport * as types from './types';\nimport { SpotifyActionsTypes } from './actions';\n\nconst initialState: types.ISpotifyState = {\n    isTokenExpired: false,\n    songsLoadingStatus: \"waiting\",\n    songs: [],\n    actualSong: null,\n    isSpotifyPlayerActive: true,\n};\n\nconst reducer = (\n    state = initialState,\n    action: SpotifyActionsTypes,\n): types.ISpotifyState => {\n\n    switch (action.type) {\n        case types.GET_SONGS:\n        case types.SET_ACTUAL_SONG:\n        case types.LOADING_STATUS_CHANGE:\n            return {\n                ...state,\n                ...action.payload,\n            }\n        case types.TOKEN_EXPIRED:\n            return {\n                ...state,\n                isTokenExpired: true,\n            }\n        case types.TOKEN_REFRESHED:\n            return {\n                ...state,\n                isTokenExpired: false,\n            }\n        case types.IS_ACTIVE_PLAYER:\n            return {\n                ...state,\n                isSpotifyPlayerActive: true,\n            }\n        case types.NO_ACTIVE_PLAYER:\n            return {\n                ...state,\n                isSpotifyPlayerActive: false,\n            }\n        default:\n            return state;\n    }\n};\n\nexport default reducer;","\nimport * as types from './types';\nimport { MoodActionsTypes } from './actions';\n\nconst initialState: types.IMoodState = {\n    valence: 0.5,\n    energy: 0.5,\n    danceability: 0.5,\n};\n\nconst reducer = (\n    state = initialState,\n    action: MoodActionsTypes,\n): types.IMoodState => {\n\n    switch (action.type) {\n        case types.SET_VALENCE:\n        case types.SET_ENERGY:\n        case types.SET_DANCEABILITY:\n            return {\n                ...state,\n                ...action.payload,\n            }\n        default:\n            return state;\n    }\n};\n\nexport default reducer;","import { combineReducers } from 'redux';\n\nimport spotifyReducer from './spotify/reducer';\nimport moodReducer from './mood/reducer';\n\nconst rootReducer = combineReducers({\n    spotify: spotifyReducer,\n    mood: moodReducer,\n});\n\nexport default rootReducer;","export const head = {\n    title: \"Moodify\",\n    description: \"Eye-pleasant visual experience adjusts song choice depending on user mood based on spotify REST API changes dynamically application appearance according to vibrant color of album cover.\",\n    keywords: \"moodiiy,eye-pleasand,experience,music,spotify,\",\n    url: \"https://moodify.marekchoinski.com/\",\n    // image: '/thumbnail.png',\n};\n\n","import React from \"react\"\nimport { Helmet } from \"react-helmet\";\n\nimport { head } from \"../../config/head\";\n\nconst Head: React.FC = () => {\n\n    const { title, description, keywords, url } = head;\n    return (\n        <Helmet>\n            <title>{title}</title>\n            <meta property=\"og:type\" content=\"website\" />\n            <meta name=\"description\" content={description} />\n            <meta property=\"og:title\" content={title} />\n            <meta name=\"description\" content={description} />\n            <meta name=\"keywords\" content={keywords} />\n            <meta property=\"og:url\" content={url} />\n            <meta property=\"og:description\" content={description} />\n            {/* <meta property=\"og:image\" content={image} /> */}\n        </Helmet>\n    );\n}\n\nexport default Head;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport thunk from 'redux-thunk';\nimport { createStore, applyMiddleware } from 'redux';\nimport rootReducer from './redux/rootReducer';\nimport { Provider,} from 'react-redux';\nimport { composeWithDevTools } from \"redux-devtools-extension\"\nimport Head from './components/Head/Head';\n\n// const store = createStore(rootReducer, applyMiddleware(thunk));\nconst store = createStore(rootReducer, (process.env.NODE_ENV !== \"production\") ?\n  composeWithDevTools(applyMiddleware(thunk))\n  : applyMiddleware(thunk));\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <Head />\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}